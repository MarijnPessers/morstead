{"version":3,"file":"combobox.js","sourceRoot":"","sources":["../../../../../../../src/components/form/combobox.ts"],"names":["Combobox","Combobox.constructor","Combobox.allowUnknown","Combobox.data","Combobox.filterFunction","Combobox.inputTimeout","Combobox.labelField","Combobox.labelFunction","Combobox.loading","Combobox.mode","Combobox.validationError","Combobox.value","Combobox.isOpen","Combobox.query","Combobox.handleEvent","Combobox.open","Combobox.close","Combobox.destroy","Combobox.createListItems","Combobox.createNoResultItem","Combobox.defaultFilter","Combobox.defaultLabel","Combobox.filterInput","Combobox.showNoResultItem","Combobox.hideNoResultItem","Combobox.focusNextItem","Combobox.initialize","Combobox.onInputinput","Combobox.onInputkeydown","Combobox.onInputkeyup","Combobox.onListclick","Combobox.onBodyclick","Combobox.findDataField","Combobox.onListkeydown","Combobox.onListkeyup","Combobox.onToggleclick","Combobox.updateFilterList","Combobox.onFilterLabelClick","Combobox.getFilterContainer","Combobox.buildFilterList","Combobox.setValue","Combobox.setup","Combobox.setupListeners","Combobox.removeListItems"],"mappings":"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AACA,YAAYA,CAACA,KAAKA,EAAEA,QAAQA,CAACA,CAACA,CAACA,CAACA;wBACtCA,KAAIA,CAACA,KAAKA,EAAEA,CAACA;oBACjBA,CAACA;oBAEDA,EAAEA,CAACA,CAACA,aAAKA,CAACA,YAAYA,CAACA,KAAKA,EAAEA,KAAKA,CAACA,CAACA,CAACA,CAACA;wBACnCA,IAAIA,QAAQA,GAAaA,KAAIA,CAACA,KAAKA,CAACA,gBAAgBA,CAACA,OAAOA,CAACA,CAACA;wBAE9DA,EAAEA,CAACA,CAACA,CAACA,KAAKA,CAACA,QAAQA,CAACA,CAACA,CAACA;4BAClBA,EAAEA,CAACA,CAACA,KAAKA,IAAIA,QAAQA,CAACA,MAAMA,GAAGA,CAACA,CAACA,CAACA,CAACA;gCAC/BA,KAAIA,CAACA,KAAKA,EAAEA,CAACA;4BACjBA,CAACA;wBACLA,CAACA;wBAACA,IAAIA,CAACA,EAAEA,CAACA,CAACA,KAAKA,KAAKA,CAACA,CAACA,CAACA,CAACA;4BACrBA,KAAIA,CAACA,KAAKA,EAAEA,CAACA;wBACjBA,CAACA;oBAELA,CAACA;gBAELA,CAACA,CAACA,CAACA;gBAEHA,KAAIA,CAACA,KAAKA,CAACA,WAAWA,CAACA,EAAEA,CAACA,CAACA;YAC/BA,CAACA,CAACA,CAACA;YACHA,MAAMA,CAACA;QACXA,CAACA;QAEDA,EAAEA,CAACA,CAACA,CAACA,IAAIA,CAACA,IAAIA,CAACA,CAACA,CAACA;YACbA,MAAMA,CAACA;QACXA,CAACA;QACDA,IAAIA,CAACA,IAAIA,CAACA,OAAOA,CAACA,UAACA,IAASA;YACxBA,IAAIA,KAAKA,GAAWA,KAAIA,CAACA,aAAaA,CAACA,IAAIA,CAACA,CAACA;YAE7CA,IAAIA,EAAEA,GAAYA,aAAKA,CAACA,UAAUA,CAACA,aAAaA,CAACA,KAAKA,CAACA,IAAIA,CAACA,CAACA,IAAIA,CAACA,KAAKA,CAACA,CAACA,CAACA;YAC1EA,EAAEA,CAACA,SAASA,CAACA,GAAGA,IAAIA,CAACA;YACrBA,KAAIA,CAACA,KAAKA,CAACA,WAAWA,CAACA,EAAEA,CAACA,CAACA;QAC/BA,CAACA,CAACA,CAACA;IACPA,CAACA;IAEDlB;;OAEGA;IACKA,qCAAkBA,GAA1BA;QACImB,IAAMA,EAAEA,GAAYA,aAAKA,CAACA,UAAUA,CAACA,kBAAkBA,CAACA,CAACA;QACzDA,IAAIA,CAACA,KAAKA,CAACA,WAAWA,CAACA,EAAEA,CAACA,CAACA;IAC/BA,CAACA;IAEDnB;;;;OAIGA;IACKA,gCAAaA,GAArBA,UAAsBA,IAASA,EAAEA,GAAWA;QACxCoB,4DAA4DA;QAC5DA,kBAAkBA;QAElBA,EAAEA,CAACA,CAACA,IAAIA,CAACA,gBAAgBA,CAACA,CAACA,CAACA;YACxBA,IAAIA,GAAGA,IAAIA,CAACA,IAAIA,CAACA;QACrBA,CAACA;QACDA,MAAMA,CAACA,IAAIA,CAACA,QAAQA,EAAEA,CAACA,WAAWA,EAAEA,CAACA,OAAOA,CAACA,IAAIA,CAACA,KAAKA,CAACA,WAAWA,EAAEA,CAACA,GAAGA,CAACA,CAACA,CAACA;IAChFA,CAACA;IAEDpB;;;;;OAKGA;IACKA,+BAAYA,GAApBA,UAAqBA,IAASA,EAAEA,GAAWA;QACvCqB,EAAEA,CAACA,CAACA,OAAOA,IAAIA,KAAKA,QAAQA,CAACA,CAACA,CAACA;YAC3BA,MAAMA,CAACA,IAAIA,CAACA;QAChBA,CAACA;QAACA,IAAIA,CAACA,EAAEA,CAACA,CAACA,IAAIA,CAACA,UAAUA,IAAIA,IAAIA,CAACA,cAAcA,CAACA,IAAIA,CAACA,UAAUA,CAACA,CAACA,CAACA,CAACA;YACjEA,MAAMA,CAACA,IAAIA,CAACA,IAAIA,CAACA,UAAUA,CAACA,CAACA,QAAQA,EAAEA,CAACA;QAC5CA,CAACA;QACDA,uEAAuEA;QACvEA,MAAMA,CAACA,IAAIA,CAACA,QAAQA,EAAEA,CAACA;IAC3BA,CAACA;IAEDrB;;OAEGA;IACKA,8BAAWA,GAAnBA;QAAAsB,iBA6CCA;QA3CGA,EAAEA,CAACA,CAACA,CAACA,IAAIA,CAACA,IAAIA,CAACA,CAACA,CAACA;YACbA,MAAMA,CAACA;QACXA,CAACA;QACDA,MAAMA,CAACA,YAAYA,CAACA,IAAIA,CAACA,eAAeA,CAACA,CAACA;QAC1CA,IAAIA,CAACA,eAAeA,GAAGA,MAAMA,CAACA,UAAUA,CACpCA;YACIA,EAAEA,CAACA,CAACA,KAAIA,CAACA,UAAUA,KAAKA,KAAIA,CAACA,KAAKA,CAACA,CAACA,CAACA;gBACjCA,KAAIA,CAACA,UAAUA,GAAGA,KAAIA,CAACA,KAAKA,CAACA;gBAC7BA,IAAIA,OAAOA,GAAkBA,KAAIA,CAACA,IAAIA,CAACA,MAAMA,CAACA,UAACA,IAASA,EAAEA,GAAWA,EAAEA,GAAeA;oBAElFA,IAAIA,QAAQA,GAAgBA,KAAIA,CAACA,KAAKA,CAACA,QAAQA,CAACA,GAAGA,CAAgBA,CAACA;oBACpEA,IACIA,IAAIA,GAAgBA,QAAQA,CAACA,aAAaA,CAACA,iBAAiBA,CAAgBA,EAC5EA,KAAKA,GAAYA,KAAIA,CAACA,cAAcA,CAACA,IAAIA,CAACA,KAAIA,EAAEA,IAAIA,EAAEA,GAAGA,EAAEA,GAAGA,CAACA,CAACA;oBACpEA,2BAA2BA;oBAC3BA,QAAQA,CAACA,MAAMA,GAAGA,IAAIA,CAACA;oBACvBA,EAAEA,CAACA,CAACA,KAAKA,CAACA,CAACA,CAACA;wBACRA,oBAAoBA;wBACpBA,QAAQA,CAACA,MAAMA,GAAGA,KAAKA,CAACA;wBAExBA,8DAA8DA;wBAC9DA,EAAEA,CAACA,CAACA,KAAIA,CAACA,UAAUA,IAAIA,KAAIA,CAACA,KAAKA,CAACA,CAACA,CAACA;4BAChCA,IAAIA,CAACA,SAASA,GAAGA,IAAIA,CAACA,WAAWA;iCAC5BA,KAAKA,CAACA,KAAIA,CAACA,KAAKA,CAACA;iCACjBA,IAAIA,CAACA,qCAAiCA,KAAIA,CAACA,KAAKA,YAASA,CAACA,CAACA;wBACpEA,CAACA;oBAELA,CAACA;oBAACA,IAAIA,CAACA,EAAEA,CAACA,CAACA,KAAIA,CAACA,UAAUA,CAACA,CAACA,CAACA;wBACzBA,wDAAwDA;wBACxDA,IAAIA,CAACA,SAASA,GAAGA,IAAIA,CAACA,WAAWA,CAACA;oBACtCA,CAACA;oBACDA,MAAMA,CAACA,KAAKA,CAACA;gBACjBA,CAACA,CAACA,CAACA;gBAEHA,OAAOA,CAACA,MAAMA,GAAGA,KAAIA,CAACA,gBAAgBA,EAAEA,GAAGA,KAAIA,CAACA,gBAAgBA,EAAEA,CAACA;gBAEnEA,EAAEA,CAACA,CAACA,CAACA,KAAIA,CAACA,MAAMA,CAACA,CAACA,CAACA;oBACfA,KAAIA,CAACA,IAAIA,EAAEA,CAACA;gBAChBA,CAACA;YACLA,CAACA;QACLA,CAACA,EACDA,IAAIA,CAACA,YAAYA,CAACA,CAACA;IAE3BA,CAACA;IAEDtB;;OAEGA;IACKA,mCAAgBA,GAAxBA;QACIuB,IAAMA,eAAeA,GAAgBA,IAAIA,CAACA,KAAKA,CAACA,aAAaA,CAACA,6BAA6BA,CAAgBA,CAACA;QAC5GA,eAAeA,CAACA,MAAMA,GAAGA,KAAKA,CAACA;QAE/BA,sFAAsFA;QACtFA,IAAIA,CAACA,KAAKA,CAACA,mBAAmBA,CAACA,OAAOA,EAAEA,IAAIA,CAACA,CAACA;QAC9CA,IAAIA,CAACA,KAAKA,CAACA,mBAAmBA,CAACA,OAAOA,EAAEA,IAAIA,CAACA,CAACA;QAC9CA,IAAIA,CAACA,KAAKA,CAACA,mBAAmBA,CAACA,SAASA,EAAEA,IAAIA,CAACA,CAACA;IACpDA,CAACA;IAEDvB;;OAEGA;IACKA,mCAAgBA,GAAxBA;QACIwB,IAAMA,eAAeA,GAAgBA,IAAIA,CAACA,KAAKA,CAACA,aAAaA,CAACA,6BAA6BA,CAAgBA,CAACA;QAC5GA,eAAeA,CAACA,MAAMA,GAAGA,IAAIA,CAACA;QAE9BA,6BAA6BA;QAC7BA,EAAEA,CAACA,CAACA,CAACA,IAAIA,CAACA,gBAAgBA,CAACA,CAACA,CAACA;YACzBA,IAAIA,CAACA,KAAKA,CAACA,gBAAgBA,CAACA,OAAOA,EAAEA,IAAIA,CAACA,CAACA;QAC/CA,CAACA;QAEDA,IAAIA,CAACA,KAAKA,CAACA,gBAAgBA,CAACA,OAAOA,EAAEA,IAAIA,CAACA,CAACA;QAC3CA,IAAIA,CAACA,KAAKA,CAACA,gBAAgBA,CAACA,SAASA,EAAEA,IAAIA,CAACA,CAACA;IACjDA,CAACA;IAEDxB;;;OAGGA;IACKA,gCAAaA,GAArBA,UAAsBA,SAAqBA;QAArByB,yBAAqBA,GAArBA,aAAqBA;QAEvCA,IAAIA,aAAaA,GAAgBA,QAAQA,CAACA,aAA4BA,CAACA;QAEvEA,yCAAyCA;QACzCA,EAAEA,CAACA,CACCA,aAAaA,CAACA,SAASA,CAACA,QAAQA,CAACA,gBAAgBA,CAACA;YAClDA,aAAKA,CAACA,YAAYA,CAACA,aAAaA,EAAEA,IAAIA,CAACA,IAAIA,CAACA,CAACA,CAACA,CAACA;YAE/CA,oCAAoCA;YACpCA,IAAIA,MAAMA,GAAWA,SAASA,KAAKA,CAACA,GAAGA,oBAAoBA,GAAGA,wBAAwBA,CAACA;YAEvFA,+DAA+DA;YAC/DA,sBAAsBA;YACtBA,OAAOA,aAAaA,CAACA,MAAMA,CAACA,EAAEA,CAACA;gBAC3BA,aAAaA,GAAGA,aAAaA,CAACA,MAAMA,CAACA,CAACA;gBACtCA,EAAEA,CAACA,CAACA,CAACA,aAAaA,CAACA,MAAMA,CAACA,CAACA,CAACA;oBACxBA,qCAAqCA;oBACrCA,aAAaA,CAACA,KAAKA,EAAEA,CAACA;oBACtBA,KAAKA,CAACA;gBACVA,CAACA;YACLA,CAACA;QAELA,CAACA;QAACA,IAAIA,CAACA,CAACA;YACJA,IAAMA,KAAKA,GAAaA,IAAIA,CAACA,KAAKA,CAACA,gBAAgBA,CAACA,iBAAiBA,CAACA,CAACA;YAEvEA,GAAGA,CAACA,CAACA,GAAGA,CAACA,CAACA,GAAWA,CAACA,EAAEA,CAACA,GAAWA,KAAKA,CAACA,MAAMA,EAAEA,CAACA,GAAGA,CAACA,EAAEA,CAACA,IAAIA,CAACA,EAAEA,CAACA;gBAC9DA,IAAMA,IAAIA,GAAgBA,KAAKA,CAACA,CAACA,CAAgBA,CAACA;gBAElDA,EAAEA,CAACA,CAACA,CAACA,IAAIA,CAACA,YAAYA,CAACA,QAAQA,CAACA,CAACA,CAACA,CAACA;oBAC/BA,IAAIA,CAACA,KAAKA,EAAEA,CAACA;oBACbA,KAAKA,CAACA;gBACVA,CAACA;YACLA,CAACA;QACLA,CAACA;IACLA,CAACA;IAEDzB;;;OAGGA;IACKA,6BAAUA,GAAlBA;QAAA0B,iBAgBCA;QAfGA,YAAYA,CAACA,IAAIA,CAACA,cAAcA,CAACA,CAACA;QAElCA,IAAIA,CAACA,cAAcA,GAAGA,MAAMA,CAACA,UAAUA,CACnCA;YACIA,KAAIA,CAACA,eAAeA,EAAEA,CAACA;YACvBA,KAAIA,CAACA,eAAeA,EAAEA,CAACA;YACvBA,KAAIA,CAACA,kBAAkBA,EAAEA,CAACA;YAE1BA,EAAEA,CAACA,CAACA,KAAIA,CAACA,IAAIA,KAAKA,yBAAiBA,CAACA,CAACA,CAACA;gBAClCA,KAAIA,CAACA,WAAWA,EAAEA,CAACA;YACvBA,CAACA;QAELA,CAACA,EACDA,IAAIA,CAACA,YAAYA,CAACA,CAACA;IAE3BA,CAACA;IAED1B;;OAEGA;IACKA,+BAAYA,GAApBA;QACI2B,EAAEA,CAACA,CAACA,IAAIA,CAACA,IAAIA,IAAIA,CAACA,IAAIA,CAACA,YAAYA,IAAIA,IAAIA,CAACA,IAAIA,CAACA,OAAOA,CAACA,IAAIA,CAACA,MAAMA,CAACA,KAAKA,CAACA,KAAKA,CAACA,CAACA,CAACA,CAACA,CAACA;YACjFA,IAAIA,CAACA,MAAMA,CAACA,iBAAiBA,CAACA,IAAIA,CAACA,eAAeA,CAACA,CAACA;QACxDA,CAACA;QAACA,IAAIA,CAACA,CAACA;YACJA,IAAIA,CAACA,MAAMA,CAACA,iBAAiBA,CAACA,EAAEA,CAACA,CAACA;QACtCA,CAACA;IACLA,CAACA;IAED3B;;;;OAIGA;IACKA,iCAAcA,GAAtBA,UAAuBA,KAAoBA;QACvC4B,KAAKA,CAACA,eAAeA,EAAEA,CAACA;IAC5BA,CAACA;IAED5B;;;;;OAKGA;IACKA,+BAAYA,GAApBA,UAAqBA,KAAoBA;QACrC6B,EAAEA,CAACA,CAACA,aAAKA,CAACA,YAAYA,CAACA,KAAKA,EAAEA,QAAQA,CAACA,CAACA,CAACA,CAACA;YACtCA,MAAMA,CAACA,IAAIA,CAACA,KAAKA,EAAEA,CAACA;QACxBA,CAACA;QAACA,IAAIA,CAACA,EAAEA,CAACA,CAACA,aAAKA,CAACA,YAAYA,CAACA,KAAKA,EAAEA,WAAWA,CAACA,IAAIA,aAAKA,CAACA,YAAYA,CAACA,KAAKA,EAAEA,SAASA,CAACA,CAACA,CAACA,CAACA;YACxFA,EAAEA,CAACA,CAACA,CAACA,IAAIA,CAACA,MAAMA,CAACA,CAACA,CAACA;gBACfA,IAAIA,CAACA,IAAIA,EAAEA,CAACA;gBACZA,IAAMA,IAAIA,GAAgBA,IAAIA,CAACA,KAAKA,CAACA,aAAaA,CAACA,iBAAiBA,CAAgBA,CAACA;gBACrFA,EAAEA,CAACA,CAACA,IAAIA,CAACA,CAACA,CAACA;oBACPA,IAAIA,CAACA,KAAKA,EAAEA,CAACA;gBACjBA,CAACA;YACLA,CAACA;YAACA,IAAIA,CAACA,CAACA;gBACJA,IAAIA,CAACA,aAAaA,CAACA,aAAKA,CAACA,YAAYA,CAACA,KAAKA,EAAEA,WAAWA,CAACA,GAAGA,CAACA,GAAGA,CAACA,CAACA,CAACA,CAACA;YACxEA,CAACA;QACLA,CAACA;QAEDA,EAAEA,CAACA,CAACA,IAAIA,CAACA,IAAIA,KAAKA,mBAAWA,CAACA,CAACA,CAACA;YAC5BA,IAAIA,CAACA,MAAMA,GAAGA,IAAIA,CAACA;YACnBA,IAAIA,CAACA,WAAWA,EAAEA,CAACA;QACvBA,CAACA;IACLA,CAACA;IAED7B;;;OAGGA;IACKA,8BAAWA,GAAnBA,UAAoBA,KAAYA;QAC5B8B,IAAIA,CAACA,QAAQA,CAACA,IAAIA,CAACA,aAAaA,CAACA,KAAKA,CAACA,MAAqBA,CAACA,CAACA,CAACA;IACnEA,CAACA;IAEO9B,8BAAWA,GAAnBA,UAAoBA,KAAYA;QAE5B+B,EAAEA,CAACA,CAACA,KAAKA,CAACA,MAAMA,KAAKA,IAAIA,CAACA,MAAMA;YAC5BA,KAAKA,CAACA,MAAMA,KAAKA,IAAIA,CAACA,OAAOA;YAC7BA,KAAKA,CAACA,MAAMA,KAAKA,IAAIA,CAACA,KAAKA;YAC3BA,KAAKA,CAACA,MAAMA,KAAKA,IAAIA,CAACA,KAAKA,CAACA,CAACA,CAACA;YAE9BA,kEAAkEA;YAClEA,EAAEA,CAACA,CAACA,IAAIA,CAACA,gBAAgBA,IAAIA,IAAIA,CAACA,aAAaA,CAACA,KAAKA,CAACA,MAAqBA,CAACA,IAAIA,IAAIA,CAACA,CAACA,CAACA;gBACnFA,MAAMA,CAACA;YACXA,CAACA;YAEDA,IAAIA,CAACA,KAAKA,EAAEA,CAACA;QACjBA,CAACA;IACLA,CAACA;IAED/B;;;;;;;OAOGA;IACKA,gCAAaA,GAArBA,UAAsBA,EAAeA;QACjCgC,OAAOA,EAAEA,IAAIA,CAACA,EAAEA,CAACA,SAASA,CAACA,EAAEA,CAACA;YAC1BA,EAAEA,GAAGA,EAAEA,CAACA,aAAaA,CAACA;QAC1BA,CAACA;QACDA,MAAMA,CAACA,EAAEA,IAAIA,EAAEA,CAACA,SAASA,CAACA,CAACA;IAC/BA,CAACA;IAEDhC;;;;OAIGA;IACKA,gCAAaA,GAArBA,UAAsBA,KAAoBA;QACtCiC,KAAKA,CAACA,cAAcA,EAAEA,CAACA;QACvBA,KAAKA,CAACA,eAAeA,EAAEA,CAACA;IAC5BA,CAACA;IAEDjC;;;;;;;OAOGA;IACKA,8BAAWA,GAAnBA,UAAoBA,KAAoBA;QACpCkC,KAAKA,CAACA,cAAcA,EAAEA,CAACA;QACvBA,EAAEA,CAACA,CAACA,aAAKA,CAACA,YAAYA,CAACA,KAAKA,EAAEA,QAAQA,CAACA,CAACA,CAACA,CAACA;YACtCA,IAAIA,CAACA,MAAMA,GAAGA,IAAIA,CAACA;YACnBA,IAAIA,CAACA,KAAKA,EAAEA,CAACA;QACjBA,CAACA;QAACA,IAAIA,CAACA,EAAEA,CAACA,CAACA,aAAKA,CAACA,YAAYA,CAACA,KAAKA,EAAEA,WAAWA,CAACA,IAAIA,aAAKA,CAACA,YAAYA,CAACA,KAAKA,EAAEA,SAASA,CAACA,CAACA,CAACA,CAACA;YACxFA,IAAIA,CAACA,aAAaA,CAACA,aAAKA,CAACA,YAAYA,CAACA,KAAKA,EAAEA,WAAWA,CAACA,GAAGA,CAACA,GAAGA,CAACA,CAACA,CAACA,CAACA;QACxEA,CAACA;QAACA,IAAIA,CAACA,EAAEA,CAACA,CAACA,aAAKA,CAACA,YAAYA,CAACA,KAAKA,EAAEA,OAAOA,CAACA,CAACA,CAACA,CAACA;YAC5CA,IAAIA,WAAWA,GAAgBA,QAAQA,CAACA,aAA4BA,CAACA;YACrEA,EAAEA,CAACA,CAACA,WAAWA,CAACA,SAASA,CAACA,QAAQA,CAACA,gBAAgBA,CAACA,CAACA,CAACA,CAACA;gBACnDA,IAAIA,GAAGA,GAAQA,IAAIA,CAACA,aAAaA,CAACA,WAAWA,CAACA,CAACA;gBAC/CA,IAAIA,CAACA,QAAQA,CAACA,GAAGA,CAACA,CAACA;YACvBA,CAACA;QACLA,CAACA;IACLA,CAACA;IAEDlC;;;OAGGA;IACKA,gCAAaA,GAArBA,UAAsBA,KAAYA;QAE9BmC,EAAEA,CAACA,CAACA,IAAIA,CAACA,MAAMA,CAACA,CAACA,CAACA;YACdA,IAAIA,CAACA,MAAMA,GAAGA,IAAIA,CAACA;YACnBA,IAAIA,CAACA,KAAKA,EAAEA,CAACA;QACjBA,CAACA;QAACA,IAAIA,CAACA,CAACA;YACJA,IAAIA,CAACA,IAAIA,EAAEA,CAACA;QAChBA,CAACA;IAELA,CAACA;IAEDnC;;;;;OAKGA;IACKA,mCAAgBA,GAAxBA,UAAyBA,UAAsBA;QAA/CoC,iBAmBCA;QAlBGA,IAAIA,SAASA,GAAgBA,IAAIA,CAACA,kBAAkBA,EAAEA,CAACA;QACvDA,SAASA,CAACA,SAASA,GAAGA,EAAEA,CAACA;QACzBA,IAAIA,KAAaA,CAACA;QAElBA,GAAGA,CAACA,CAACA,GAAGA,CAACA,CAACA,GAAWA,CAACA,EAAEA,CAACA,GAAGA,UAAUA,CAACA,MAAMA,EAAEA,CAACA,EAAEA,EAAEA,CAACA;YACjDA,KAAKA,GAAGA,CAACA,CAACA;YACVA,IAAIA,UAAUA,GAAgBA,aAAKA,CAACA,UAAUA,CAACA,mBAAmBA,GAAGA,UAAUA,CAACA,CAACA,CAACA,GAAGA,OAAOA,CAACA,CAACA;YAC9FA,UAAUA,CAACA,EAAEA,GAAGA,CAACA,CAACA,QAAQA,EAAEA,CAACA;YAE7BA,UAAUA,CAACA,gBAAgBA,CAACA,OAAOA,EAAEA,UAACA,KAAiBA,IAAKA,OAAAA,KAAIA,CAACA,kBAAkBA,CAACA,KAAKA,CAACA,MAAMA,CAACA,EAArCA,CAAqCA,CAACA,CAACA;YAEnGA,UAAUA,CAACA,gBAAgBA,CAACA,OAAOA,EAAEA,UAACA,KAAoBA;gBACtDA,EAAEA,CAACA,CAACA,aAAKA,CAACA,YAAYA,CAACA,KAAKA,EAAEA,OAAOA,CAACA,CAACA,CAACA,CAACA;oBACrCA,KAAIA,CAACA,kBAAkBA,CAACA,KAAKA,CAACA,MAAMA,CAACA,CAACA;gBAC1CA,CAACA;YACLA,CAACA,CAACA,CAACA;YACHA,SAASA,CAACA,WAAWA,CAACA,UAAUA,CAACA,CAACA;QACtCA,CAACA;IACLA,CAACA;IAEOpC,qCAAkBA,GAA1BA,UAA2BA,OAAoBA;QAC3CqC,qDAAqDA;QACrDA,oBAAoBA;QACpBA,EAAEA,CAACA,CAACA,IAAIA,CAACA,gBAAgBA,CAACA,CAACA,CAACA;YAExBA,IAAIA,UAAUA,GAAgBA,OAAsBA,CAACA;YAErDA,IAAIA,mBAAmBA,GACnBA,IAAIA,CAACA,KAAKA,CAACA,gBAAgBA,CAACA,yBAAyBA,CAACA,CAACA,UAAUA,CAACA,EAAEA,CAAqBA,CAACA;YAE9FA,mBAAmBA,CAACA,OAAOA,GAAGA,KAAKA,CAACA;YAEpCA,IAAIA,SAASA,GAAgBA,IAAIA,CAACA,kBAAkBA,EAAEA,CAACA;YAEvDA,mBAAmBA;YACnBA,IAAIA,CAACA,eAAeA,EAAEA,CAACA;YAEvBA,cAAcA;YACdA,EAAEA,CAACA,CAACA,SAASA,CAACA,gBAAgBA,CAACA,IAAIA,CAACA,CAACA,MAAMA,KAAKA,CAACA,CAACA,CAACA,CAACA;gBAChDA,aAAaA;gBACbA,IAAIA,CAACA,MAAMA,CAACA,KAAKA,EAAEA,CAACA;YACxBA,CAACA;YAACA,IAAIA,CAACA,CAACA;gBACJA,yBAAyBA;gBACzBA,IAAIA,eAAeA,GAAWA,QAAQA,CAACA,UAAUA,CAACA,EAAEA,CAACA,GAAGA,CAACA,GAAGA,QAAQA,CAACA,UAAUA,CAACA,EAAEA,CAACA,GAAGA,CAACA,GAAGA,CAACA,CAACA;gBAC5FA,IAAIA,aAAaA,GAAgBA,SAASA,CAACA,gBAAgBA,CAACA,IAAIA,CAACA,CAACA,eAAeA,CAAgBA,CAACA;gBAClGA,aAAaA,CAACA,KAAKA,EAAEA,CAACA;YAC1BA,CAACA;QACLA,CAACA;IAELA,CAACA;IAEDrC;;;;;OAKGA;IACKA,qCAAkBA,GAA1BA;QAEIsC,8BAA8BA;QAC9BA,EAAEA,CAACA,CAACA,IAAIA,CAACA,gBAAgBA,KAAKA,IAAIA,CAACA,CAACA,CAACA;YAEjCA,iDAAiDA;YACjDA,IAAIA,CAACA,gBAAgBA,GAAGA,IAAIA,CAACA,IAAIA,CAACA,aAAaA,CAACA,eAAeA,CAAgBA,CAACA;YAChFA,EAAEA,CAACA,CAACA,IAAIA,CAACA,gBAAgBA,KAAKA,IAAIA,CAACA,CAACA,CAACA;gBACjCA,wDAAwDA;gBACxDA,IAAIA,CAACA,gBAAgBA,GAAGA,aAAKA,CAACA,UAAUA,CAACA,8EAA4EA,CAACA,CAACA;gBACvHA,IAAIA,CAACA,IAAIA,CAACA,YAAYA,CAACA,IAAIA,CAACA,gBAAgBA,EAAEA,IAAIA,CAACA,IAAIA,CAACA,aAAaA,CAACA,kBAAkBA,CAACA,CAACA,CAACA;YAC/FA,CAACA;QACLA,CAACA;QAEDA,MAAMA,CAACA,IAAIA,CAACA,gBAAgBA,CAACA;IACjCA,CAACA;IAEDtC;;OAEGA;IACKA,kCAAeA,GAAvBA;QACIuC,IAAIA,CAACA,MAAMA,GAAGA,EAAEA,CAACA;QACjBA,IAAIA,YAAYA,GAAwBA,IAAIA,CAACA,KAAKA,CAACA,gBAAgBA,CAACA,yBAAyBA,CAACA,CAACA;QAC/FA,GAAGA,CAACA,CAACA,GAAGA,CAACA,CAACA,GAAWA,CAACA,EAAEA,CAACA,GAAGA,YAAYA,CAACA,MAAMA,EAAEA,CAACA,EAAEA,EAAEA,CAACA;YACnDA,IAAIA,CAACA,MAAMA,CAACA,IAAIA,CAACA,YAAYA,CAACA,CAACA,CAACA,CAACA,aAAaA,CAACA,aAAaA,CAACA,eAAeA,CAACA,CAACA,WAAWA,CAACA,CAACA;QAC/FA,CAACA;QACDA,IAAIA,CAACA,gBAAgBA,CAACA,IAAIA,CAACA,MAAMA,CAACA,CAACA;IACvCA,CAACA;IAEDvC;;;;OAIGA;IACKA,2BAAQA,GAAhBA,UAAiBA,KAAUA;QACvBwC,IAAIA,KAAKA,GAAQA,QAAQA,CAACA,WAAWA,CAACA,aAAaA,CAACA,CAACA;QACrDA,KAAKA,CAACA,SAASA,CAACA,iBAAiBA,EAAEA,IAAIA,EAAEA,IAAIA,CAACA,CAACA;QAC/CA,KAAKA,CAACA,IAAIA,GAAGA,KAAKA,CAACA;QAEnBA,EAAEA,CAACA,CAACA,CAACA,IAAIA,CAACA,gBAAgBA,IAAIA,IAAIA,CAACA,IAAIA,CAACA,aAAaA,CAACA,KAAKA,CAACA,CAACA,CAACA,CAACA;YAC3DA,IAAIA,CAACA,KAAKA,GAAGA,KAAKA,CAACA;YACnBA,IAAIA,CAACA,KAAKA,EAAEA,CAACA;QACjBA,CAACA;IACLA,CAACA;IAEDxC;;OAEGA;IACKA,wBAAKA,GAAbA;QACIyC,EAAEA,CAACA,CAACA,CAACA,IAAIA,CAACA,IAAIA,CAACA,aAAaA,CAACA,kBAAkBA,CAACA,CAACA,CAACA,CAACA;YAC/CA,MAAMA,IAAIA,KAAKA,CAACA,0CAA0CA,CAACA,CAACA;QAChEA,CAACA;QAEDA,EAAEA,CAACA,CAACA,CAACA,IAAIA,CAACA,IAAIA,CAACA,SAASA,CAACA,QAAQA,CAACA,UAAUA,CAACA,CAACA,CAACA,CAACA;YAC5CA,IAAIA,CAACA,IAAIA,CAACA,SAASA,CAACA,GAAGA,CAACA,UAAUA,CAACA,CAACA;QACxCA,CAACA;QAEDA,+BAA+BA;QAC/BA,EAAEA,CAACA,CAACA,CAACA,IAAIA,CAACA,IAAIA,CAACA,aAAaA,CAACA,iBAAiBA,CAACA,CAACA,CAACA,CAACA;YAC9CA,IAAIA,CAACA,KAAKA,GAAGA,aAAKA,CAACA,UAAUA,CAACA,4EAAwEA,CAAgBA,CAACA;YACvHA,IAAIA,CAACA,IAAIA,CAACA,WAAWA,CAACA,IAAIA,CAACA,KAAKA,CAACA,CAACA;QACtCA,CAACA;QAEDA,iCAAiCA;QACjCA,IAAIA,CAACA,OAAOA,GAAGA,IAAIA,CAACA,IAAIA,CAACA,aAAaA,CAACA,mBAAmBA,CAACA,CAACA;QAE5DA,EAAEA,CAACA,CAACA,CAACA,IAAIA,CAACA,OAAOA,CAACA,CAACA,CAACA;YAChBA,uBAAuBA;YACvBA,IAAIA,CAACA,OAAOA,GAAGA,aAAKA,CAACA,UAAUA,CAACA,8DAA0DA,CAACA,CAACA;YAC5FA,IAAIA,CAACA,IAAIA,CAACA,WAAWA,CAACA,IAAIA,CAACA,OAAOA,CAACA,CAACA;QACxCA,CAACA;QAEDA,4CAA4CA;QAC5CA,EAAEA,CAACA,CAACA,CAACA,IAAIA,CAACA,IAAIA,CAACA,aAAaA,CAACA,yBAAyBA,CAACA,CAACA,CAACA,CAACA;YACtDA,IAAIA,IAAIA,GAAYA,aAAKA,CAACA,UAAUA,CAChCA,yQAKQA,CAACA,CAACA;YAEdA,IAAIA,CAACA,IAAIA,CAACA,WAAWA,CAACA,IAAIA,CAACA,CAACA;QAEhCA,CAACA;QAEDA,gCAAgCA;QAChCA,IAAIA,CAACA,KAAKA,GAAGA,IAAIA,CAACA,IAAIA,CAACA,aAAaA,CAACA,iBAAiBA,CAAgBA,CAACA;QAEvEA,iFAAiFA;QACjFA,EAAEA,CAACA,CAACA,IAAIA,CAACA,gBAAgBA,CAACA,CAACA,CAACA;YAExBA,mBAAmBA;YACnBA,IAAIA,CAACA,KAAKA,CAACA,SAASA,CAACA,GAAGA,CAACA,0BAA0BA,CAACA,CAACA;YAErDA,IAAIA,CAACA,KAAKA,CAACA,YAAYA,CAACA,UAAUA,EAAEA,IAAIA,CAACA,CAACA;YAE1CA,qCAAqCA;YACrCA,IAAIA,cAAcA,GAAqBA,IAAIA,CAACA,IAAIA,CAACA,aAAaA,CAACA,kBAAkBA,CAAqBA,CAACA;YAEvGA,sCAAsCA;YACtCA,IAAIA,CAACA,KAAKA,GAAGA,EAAEA,CAACA;YAChBA,GAAGA,CAACA,CAACA,GAAGA,CAACA,CAACA,GAAWA,CAACA,EAAEA,CAACA,GAAGA,cAAcA,CAACA,QAAQA,CAACA,MAAMA,EAAEA,CAACA,EAAEA,EAAEA,CAACA;gBAC9DA,IAAIA,CAACA,KAAKA,CAACA,IAAIA,CAACA,EAAEA,IAAIA,EAAEA,cAAcA,CAACA,QAAQA,CAACA,CAACA,CAACA,CAACA,WAAWA,EAAEA,KAAKA,EAAEA,EAAEA,EAAEA,CAACA,CAACA;YACjFA,CAACA;YAEDA,uEAAuEA;YACvEA,IAAIA,YAAYA,GAAYA,aAAKA,CAACA,UAAUA,CAACA,WAAWA,CAACA,CAACA;YAC1DA,YAAYA,CAACA,SAASA,GAAGA,cAAcA,CAACA,SAASA,CAACA;YAClDA,IAAIA,CAACA,IAAIA,CAACA,YAAYA,CAACA,YAAYA,EAAEA,cAAcA,CAACA,CAACA;YAErDA,+BAA+BA;YAC/BA,IAAIA,CAACA,eAAeA,EAAEA,CAACA;YAEvBA,qCAAqCA;YACrCA,IAAIA,CAACA,kBAAkBA,EAAEA,CAACA;QAC9BA,CAACA;QAEDA,mCAAmCA;QACnCA,IAAIA,CAACA,MAAMA,GAAGA,IAAIA,CAACA,IAAIA,CAACA,aAAaA,CAACA,kBAAkBA,CAAqBA,CAACA;IAClFA,CAACA;IAEOzC,iCAAcA,GAAtBA;QAEI0C,qCAAqCA;QACrCA,IAAIA,CAACA,OAAOA,CAACA,gBAAgBA,CAACA,OAAOA,EAAEA,IAAIA,CAACA,CAACA;QAE7CA,IAAIA,CAACA,MAAMA,CAACA,gBAAgBA,CAACA,OAAOA,EAAEA,IAAIA,CAACA,CAACA;QAC5CA,IAAIA,CAACA,MAAMA,CAACA,gBAAgBA,CAACA,SAASA,EAAEA,IAAIA,CAACA,CAACA;QAC9CA,IAAIA,CAACA,MAAMA,CAACA,gBAAgBA,CAACA,OAAOA,EAAEA,IAAIA,CAACA,CAACA;QAE5CA,EAAEA,CAACA,CAACA,CAACA,IAAIA,CAACA,gBAAgBA,CAACA,CAACA,CAACA;YACzBA,IAAIA,CAACA,KAAKA,CAACA,gBAAgBA,CAACA,OAAOA,EAAEA,IAAIA,CAACA,CAACA;QAC/CA,CAACA;QAEDA,IAAIA,CAACA,KAAKA,CAACA,gBAAgBA,CAACA,OAAOA,EAAEA,IAAIA,CAACA,CAACA;QAC3CA,IAAIA,CAACA,KAAKA,CAACA,gBAAgBA,CAACA,SAASA,EAAEA,IAAIA,CAACA,CAACA;QAE7CA,QAAQA,CAACA,IAAIA,CAACA,gBAAgBA,CAACA,OAAOA,EAAEA,IAAIA,CAACA,CAACA;IAClDA,CAACA;IAED1C;;OAEGA;IACKA,kCAAeA,GAAvBA;QACI2C,cAAcA;QACdA,OAAOA,IAAIA,CAACA,KAAKA,CAACA,SAASA,EAAEA,CAACA;YAC1BA,IAAIA,CAACA,KAAKA,CAACA,WAAWA,CAACA,IAAIA,CAACA,KAAKA,CAACA,SAASA,CAACA,CAACA;QACjDA,CAACA;IACLA,CAACA;IACL3C,eAACA;AAADA,CAACA,AAv2BD,IAu2BC;AAv2BY,gBAAQ,WAu2BpB,CAAA","sourcesContent":["import { Utils } from '../../core/utils';\r\n\r\nconst ITEM_TEMPLATE: string = `<li role=\"button\" tabindex=\"-1\" class=\"combobox__item\">\r\n    <span class=\"combobox__link\">%s</span>\r\n </li>`;\r\n\r\nconst NO_RESULT_TEMPLATE: string = `<li tabindex=\"-1\" class=\"combobox__item combobox__item--no-results\" hidden>\r\n <span class=\"combobox__link\">Geen resultaten gevonden.</span>\r\n</li>`;\r\n\r\nconst ITEM_COMBOBOX_TEMPLATE: string = `<li class=\"input__group input__group--compact input__group--checkbox\" role=\"group\">\r\n<input role=checkbox type=\"checkbox\" id=\"chkbx-compact-$id\" class=\"input__control input__control--checkbox\">\r\n<label class=\"input__label input__label--checkbox combobox__link\" for=\"chkbx-compact-$id\">$label</label>\r\n</li>`;\r\n\r\nconst DATAFIELD: string = 'comboboxItem';\r\n\r\nexport const MODE_FILTER: number = 1;\r\nexport const MODE_AUTOCOMPLETE: number = 2;\r\n\r\n/**\r\n * Combobox / autocomplete component\r\n * @version 1.0.0\r\n *\r\n * <div class=\"input combobox\">\r\n *  <label class=\"input__label\">Opleiding</label>\r\n *  <div class=\"input__hint\">Voer een opleidingsnaam of crebonummer in</div>\r\n *  <input type=\"text\" class=\"combobox__input input__control input__control--text input__control--xl input__control--select\">\r\n * </div>\r\n */\r\nexport class Combobox implements EventListenerObject {\r\n\r\n    private _allowUnknown: Boolean = true;\r\n    private _data: Array<any>;\r\n    private _filterFunction: any = this.defaultFilter;\r\n    private _icon: HTMLElement;\r\n    private _initTimeoutId: number;\r\n    private _initTimeout: number = 2;\r\n    private _inputTimeout: number = 100;\r\n    private _inputTimeoutId: number;\r\n    private _input: HTMLInputElement;\r\n    private _list: HTMLElement;\r\n    private _labelField: string;\r\n    private _labelFunction: any = this.defaultLabel;\r\n    private _loading: boolean = false;\r\n    private _mode: number = MODE_FILTER;\r\n    private _prevQuery: string;\r\n    private _toggle: Element;\r\n    private _validationError: string = 'Ongeldige invoer';\r\n    private _value: any = null;\r\n    private _filterContainer: HTMLElement = null;\r\n    /**\r\n     * Highlight matched text? Only on default filter\r\n     * @type {boolean}\r\n     * @private\r\n     */\r\n    private _highlight: boolean = true;\r\n\r\n    constructor(private host: Element, private isCheckboxFilter: Boolean = false) {\r\n\r\n        if (!host) {\r\n            throw new Error('No host element specified');\r\n        }\r\n\r\n        this.setup();\r\n        this.setupListeners();\r\n    }\r\n\r\n    /**\r\n     * Indicates whether or not an entered value must be present in the\r\n     * data list.\r\n     * @default true\r\n     * @return {Boolean}\r\n     */\r\n    get allowUnknown(): Boolean {\r\n        return this._allowUnknown;\r\n    }\r\n\r\n    set allowUnknown(value: Boolean) {\r\n        this._allowUnknown = value;\r\n    }\r\n\r\n    get data(): Array<any> {\r\n        return this._data;\r\n    }\r\n\r\n    /**\r\n     * Sets the values of the combobox, can be an array of strings or\r\n     * an array objects. When using objects, be sure to set the `labelField`\r\n     * property\r\n     * @param {Array<any>} value\r\n     */\r\n    set data(value: Array<any>) {\r\n        this._data = value;\r\n        this.initialize();\r\n    }\r\n\r\n    /**\r\n     * A custom filter function for the data array.\r\n     * Signature: function(element: any, index: number, array: any[]): boolean\r\n     * @see https://developer.mozilla.org/nl/docs/Web/JavaScript/Reference/Global_Objects/Array/filter\r\n     * @return {Function}\r\n     */\r\n    get filterFunction(): any {\r\n        return this._filterFunction;\r\n    }\r\n\r\n    set filterFunction(value: any) {\r\n        this._highlight = false;\r\n        this._filterFunction = value;\r\n    }\r\n\r\n    /**\r\n     * The number of milliseconds to wait before applying the filtering after the user\r\n     * has changed the input\r\n     * @return {string}\r\n     */\r\n    get inputTimeout(): number {\r\n        return this._inputTimeout;\r\n    }\r\n\r\n    set inputTimeout(value: number) {\r\n        this._inputTimeout = value;\r\n    }\r\n    /**\r\n     * Sets which property of the objects to use to display in the list\r\n     * @return {string}\r\n     */\r\n    get labelField(): string {\r\n        return this._labelField;\r\n    }\r\n\r\n    set labelField(value: string) {\r\n        this._labelField = value;\r\n        this.initialize();\r\n    }\r\n\r\n    /**\r\n     * Sets which property of the objects to use to display in the list. May contain HTML\r\n     * Signature: function(value: any): string\r\n     * @return {function}\r\n     */\r\n    get labelFunction(): any {\r\n        return this._labelFunction;\r\n    }\r\n\r\n    set labelFunction(value: any) {\r\n        this._labelFunction = value;\r\n        this.initialize();\r\n    }\r\n\r\n    /**\r\n     * Indicates the combobox is loading data\r\n     * @return {boolean}\r\n     */\r\n    get loading(): boolean {\r\n        return this._loading;\r\n    }\r\n\r\n    set loading(isLoading: boolean) {\r\n        this._loading = isLoading;\r\n        if (this._icon) {\r\n            let action: string = isLoading ? 'add' : 'remove';\r\n            this._icon.classList[action]('combobox__icon--loading');\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Set the mode of the combobox\r\n     * MODE_AUTOCOMPLETE: Always show the full list\r\n     * MODE_FILTER: Filter the list based on the input value\r\n     * @return {number}\r\n     */\r\n    get mode(): number {\r\n        return this._mode;\r\n    }\r\n\r\n    set mode(value: number) {\r\n        this._mode = value;\r\n    }\r\n\r\n    /**\r\n     * Set the error which is shown when the form is validated and the value\r\n     * of the combobox is invalid\r\n     * @return {string}\r\n     */\r\n    get validationError(): string {\r\n        return this._validationError;\r\n    }\r\n\r\n    set validationError(value: string) {\r\n        this._validationError = value;\r\n    }\r\n\r\n    get value(): any {\r\n        return this._value;\r\n    }\r\n\r\n    /**\r\n     * Sets the current selected value of the combobox\r\n     * @param value\r\n     */\r\n    set value(value: any) {\r\n        if (!this.allowUnknown && this.data.indexOf(value) === -1) {\r\n            throw new Error(`Unknown item '${value.toString()}'`);\r\n        }\r\n        this._value = value;\r\n        const el: HTMLElement = document.createElement('div');\r\n        el.innerHTML = this.labelFunction(value);\r\n        this._input.value = el.textContent;\r\n    }\r\n\r\n    /**\r\n     * Indicates if the list of the combobox is visible to the user\r\n     * @readonly\r\n     * @return {boolean}\r\n     */\r\n    get isOpen(): boolean {\r\n        return this.host.classList.contains('combobox--autocomplete-open');\r\n    }\r\n\r\n    /**\r\n     * Returns the current value of the input\r\n     * @return {string}\r\n     */\r\n    get query(): string {\r\n        return this._input ? this._input.value : undefined;\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * @param {Event} event\r\n     */\r\n    handleEvent(event: Event): void {\r\n\r\n        switch (event.currentTarget) {\r\n            case this._toggle:\r\n                this[`onToggle${event.type}`](event);\r\n                break;\r\n            case this._list:\r\n                if (!this.isCheckboxFilter) {\r\n                    this[`onList${event.type}`](event);\r\n                }\r\n                break;\r\n            case this._input:\r\n                this[`onInput${event.type}`](event);\r\n                break;\r\n            case document.body:\r\n                this[`onBody${event.type}`](event);\r\n                break;\r\n\r\n            default:\r\n            /* nothing */\r\n\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Opens the dropdown\r\n     * @fires 'combobox-open'\r\n     */\r\n    open(): void {\r\n        if (!this.data) {\r\n            return;\r\n        }\r\n\r\n        const event: any = document.createEvent('CustomEvent');\r\n        event.initEvent('combobox-open', true, true);\r\n\r\n        if (this.host.dispatchEvent(event)) {\r\n            if (!this.isOpen) {\r\n                // (Re-)opening the combobox. Reset the query to force filtering\r\n                this._prevQuery = null;\r\n            }\r\n            this.host.classList.add('combobox--autocomplete-open');\r\n            this._list.hidden = false;\r\n            this.filterInput();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Closes the dropdown\r\n     * @fires 'combobox-close'\r\n     */\r\n    close(): void {\r\n\r\n        if (!this.isOpen) {\r\n            return;\r\n        }\r\n        const event: any = document.createEvent('CustomEvent');\r\n        event.initEvent('combobox-close', true, true);\r\n\r\n        if (this.host.dispatchEvent(event)) {\r\n            this.host.classList.remove('combobox--autocomplete-open');\r\n            this._list.hidden = true;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Call when the combobox is removed from the page\r\n     * Clean up listeners\r\n     */\r\n    destroy(): void {\r\n        this._toggle.removeEventListener('click', this);\r\n\r\n        this._input.removeEventListener('keyup', this);\r\n        this._input.removeEventListener('keydown', this);\r\n        this._input.removeEventListener('input', this);\r\n\r\n        this._list.removeEventListener('click', this);\r\n        this._list.removeEventListener('keyup', this);\r\n        this._list.removeEventListener('keydown', this);\r\n        this._list.remove();\r\n\r\n        document.body.removeEventListener('click', this);\r\n    }\r\n\r\n    /**\r\n     * Create the listitems based on the data array\r\n     */\r\n    private createListItems(): void {\r\n        if (this.isCheckboxFilter) {\r\n\r\n            this.data.forEach((item: any, index: number) => {\r\n                let el: Element = Utils.CreateNode(ITEM_COMBOBOX_TEMPLATE\r\n                    .replace('$label', item.name)\r\n                    .replace(/\\$id/g, index.toString()));\r\n                el[DATAFIELD] = item;\r\n\r\n                el.querySelector('input').addEventListener('change', () => {\r\n                    this.buildFilterList();\r\n                });\r\n\r\n                el.querySelector('input').addEventListener('keydown', (event: KeyboardEvent): void => {\r\n\r\n                    if (Utils.IsKeyPressed(event, 'Escape')) {\r\n                        this.close();\r\n                    }\r\n\r\n                    if (Utils.IsKeyPressed(event, 'Tab')) {\r\n                        let allItems: NodeList = this._list.querySelectorAll('input');\r\n\r\n                        if (!event.shiftKey) {\r\n                            if (index >= allItems.length - 1) {\r\n                                this.close();\r\n                            }\r\n                        } else if (index === 0) {\r\n                            this.close();\r\n                        }\r\n\r\n                    }\r\n\r\n                });\r\n\r\n                this._list.appendChild(el);\r\n            });\r\n            return;\r\n        }\r\n\r\n        if (!this.data) {\r\n            return;\r\n        }\r\n        this.data.forEach((item: any) => {\r\n            let label: string = this.labelFunction(item);\r\n\r\n            let el: Element = Utils.CreateNode(ITEM_TEMPLATE.split('%s').join(label));\r\n            el[DATAFIELD] = item;\r\n            this._list.appendChild(el);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Adds a no result node to the list.\r\n     */\r\n    private createNoResultItem(): void {\r\n        const el: Element = Utils.CreateNode(NO_RESULT_TEMPLATE);\r\n        this._list.appendChild(el);\r\n    }\r\n\r\n    /**\r\n     * This is the default filterFunction.\r\n     * @param item\r\n     * @param idx\r\n     */\r\n    private defaultFilter(item: any, idx: number): boolean {\r\n        // Return if matched, this way, we can easily check if there\r\n        // are any matches\r\n\r\n        if (this.isCheckboxFilter) {\r\n            item = item.name;\r\n        }\r\n        return item.toString().toLowerCase().indexOf(this.query.toLowerCase()) > -1;\r\n    }\r\n\r\n    /**\r\n     * This is the default labelFunction, which will return the item if it's a string,\r\n     * or the labelField if it's an object\r\n     * @param item\r\n     * @param idx\r\n     */\r\n    private defaultLabel(item: any, idx: number): string {\r\n        if (typeof item === 'string') {\r\n            return item;\r\n        } else if (this.labelField && item.hasOwnProperty(this.labelField)) {\r\n            return item[this.labelField].toString();\r\n        }\r\n        // Fallback, we don't want to do this, probably returns [Object object]\r\n        return item.toString();\r\n    }\r\n\r\n    /**\r\n     * Filters the list based on the value of the input\r\n     */\r\n    private filterInput(): void {\r\n\r\n        if (!this.data) {\r\n            return;\r\n        }\r\n        window.clearTimeout(this._inputTimeoutId);\r\n        this._inputTimeoutId = window.setTimeout(\r\n            () => {\r\n                if (this._prevQuery !== this.query) {\r\n                    this._prevQuery = this.query;\r\n                    let results: Array<string> = this.data.filter((item: any, idx: number, arr: Array<any>) => {\r\n\r\n                        let listItem: HTMLElement = this._list.children[idx] as HTMLElement;\r\n                        let\r\n                            link: HTMLElement = listItem.querySelector('.combobox__link') as HTMLElement,\r\n                            match: boolean = this.filterFunction.call(this, item, idx, arr);\r\n                        // Initially hide all items\r\n                        listItem.hidden = true;\r\n                        if (match) {\r\n                            // Show only matches\r\n                            listItem.hidden = false;\r\n\r\n                            // When using the default filter, we can highlight the results\r\n                            if (this._highlight && this.query) {\r\n                                link.innerHTML = link.textContent\r\n                                    .split(this.query)\r\n                                    .join(`<span class=\"combobox__match\">${this.query}</span>`);\r\n                            }\r\n\r\n                        } else if (this._highlight) {\r\n                            // Reset matches for non matching items (remove <spans>)\r\n                            link.nodeValue = link.textContent;\r\n                        }\r\n                        return match;\r\n                    });\r\n\r\n                    results.length ? this.hideNoResultItem() : this.showNoResultItem();\r\n\r\n                    if (!this.isOpen) {\r\n                        this.open();\r\n                    }\r\n                }\r\n            },\r\n            this.inputTimeout);\r\n\r\n    }\r\n\r\n    /**\r\n     * Show the no result item in the dropdown.\r\n     */\r\n    private showNoResultItem(): void {\r\n        const noResultElement: HTMLElement = this._list.querySelector('.combobox__item--no-results') as HTMLElement;\r\n        noResultElement.hidden = false;\r\n\r\n        // remove event listeners because we don't want the no result item to be interactable.\r\n        this._list.removeEventListener('click', this);\r\n        this._list.removeEventListener('keyup', this);\r\n        this._list.removeEventListener('keydown', this);\r\n    }\r\n\r\n    /**\r\n     * Hide the no result item in the dropdown.\r\n     */\r\n    private hideNoResultItem(): void {\r\n        const noResultElement: HTMLElement = this._list.querySelector('.combobox__item--no-results') as HTMLElement;\r\n        noResultElement.hidden = true;\r\n\r\n        // reinstate event listeners.\r\n        if (!this.isCheckboxFilter) {\r\n            this._list.addEventListener('click', this);\r\n        }\r\n\r\n        this._list.addEventListener('keyup', this);\r\n        this._list.addEventListener('keydown', this);\r\n    }\r\n\r\n    /**\r\n     * Move the focus to the next item in the list\r\n     * @param {number} direction, 1 for forward, -1 for backward\r\n     */\r\n    private focusNextItem(direction: number = 1): void {\r\n\r\n        let focusableItem: HTMLElement = document.activeElement as HTMLElement;\r\n\r\n        // Check if item belongs to this combobox\r\n        if (\r\n            focusableItem.classList.contains('combobox__item') &&\r\n            Utils.IsDescendant(focusableItem, this.host)) {\r\n\r\n            // Are we moving forward or backward\r\n            let method: string = direction === 1 ? 'nextElementSibling' : 'previousElementSibling';\r\n\r\n            // Find next focusable element. Focusable elements are elements\r\n            // that are not hidden\r\n            while (focusableItem[method]) {\r\n                focusableItem = focusableItem[method];\r\n                if (!focusableItem.hidden) {\r\n                    // When we found an element, focus it\r\n                    focusableItem.focus();\r\n                    break;\r\n                }\r\n            }\r\n\r\n        } else {\r\n            const items: NodeList = this._list.querySelectorAll('.combobox__item');\r\n\r\n            for (let i: number = 0, j: number = items.length; i < j; i += 1) {\r\n                const item: HTMLElement = items[i] as HTMLElement;\r\n\r\n                if (!item.hasAttribute('hidden')) {\r\n                    item.focus();\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Called when anything which alters the displayed data has changed\r\n     * (data / labelField)\r\n     */\r\n    private initialize(): void {\r\n        clearTimeout(this._initTimeoutId);\r\n\r\n        this._initTimeoutId = window.setTimeout(\r\n            () => {\r\n                this.removeListItems();\r\n                this.createListItems();\r\n                this.createNoResultItem();\r\n\r\n                if (this.mode === MODE_AUTOCOMPLETE) {\r\n                    this.filterInput();\r\n                }\r\n\r\n            },\r\n            this._initTimeout);\r\n\r\n    }\r\n\r\n    /**\r\n     * Applies validation to the input. Called when the value of the input has changed\r\n     */\r\n    private onInputinput(): void {\r\n        if (this.data && !this.allowUnknown && this.data.indexOf(this._input.value) === -1) {\r\n            this._input.setCustomValidity(this.validationError);\r\n        } else {\r\n            this._input.setCustomValidity('');\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Called when the user uses keyboard nav on the input,\r\n     * prevents body scrolling and event propagation.\r\n     * @param {KeyboardEvent} event\r\n     */\r\n    private onInputkeydown(event: KeyboardEvent): void {\r\n        event.stopPropagation();\r\n    }\r\n\r\n    /**\r\n     * Keyboard handler for the input\r\n     * Escape: Close the dropdown\r\n     * ArrowDown / ArrowUp: Move the focus to the list\r\n     * @param {KeyboardEvent} event\r\n     */\r\n    private onInputkeyup(event: KeyboardEvent): void {\r\n        if (Utils.IsKeyPressed(event, 'Escape')) {\r\n            return this.close();\r\n        } else if (Utils.IsKeyPressed(event, 'ArrowDown') || Utils.IsKeyPressed(event, 'ArrowUp')) {\r\n            if (!this.isOpen) {\r\n                this.open();\r\n                const list: HTMLElement = this._list.querySelector('.combobox__item') as HTMLElement;\r\n                if (list) {\r\n                    list.focus();\r\n                }\r\n            } else {\r\n                this.focusNextItem(Utils.IsKeyPressed(event, 'ArrowDown') ? 1 : -1);\r\n            }\r\n        }\r\n\r\n        if (this.mode === MODE_FILTER) {\r\n            this._value = null;\r\n            this.filterInput();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Called when the user clicks an item from the list\r\n     * @param {Event} event\r\n     */\r\n    private onListclick(event: Event): void {\r\n        this.setValue(this.findDataField(event.target as HTMLElement));\r\n    }\r\n\r\n    private onBodyclick(event: Event): void {\r\n\r\n        if (event.target !== this._input &&\r\n            event.target !== this._toggle &&\r\n            event.target !== this._icon &&\r\n            event.target !== this._list) {\r\n\r\n            // don't close the flyout if we are checking off an checkbox item.\r\n            if (this.isCheckboxFilter && this.findDataField(event.target as HTMLElement) != null) {\r\n                return;\r\n            }\r\n\r\n            this.close();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * When the user clicks on the text instead of the list item, we need to find\r\n     * the element with the datafield.\r\n     * We traverse the parents until an element with [DATAFIELD] is found, or no parent is found (should not happen)\r\n     *\r\n     * @param {HTMLElement} el\r\n     * @returns {any}\r\n     */\r\n    private findDataField(el: HTMLElement): any {\r\n        while (el && !el[DATAFIELD]) {\r\n            el = el.parentElement;\r\n        }\r\n        return el && el[DATAFIELD];\r\n    }\r\n\r\n    /**\r\n     * Called when the user uses keyboard nav inside the list,\r\n     * prevents body scrolling and event propagation\r\n     * @param {KeyboardEvent} event\r\n     */\r\n    private onListkeydown(event: KeyboardEvent): void {\r\n        event.preventDefault();\r\n        event.stopPropagation();\r\n    }\r\n\r\n    /**\r\n     * Keyboard handling for the select list,\r\n     * Escape: Close the dropdown\r\n     * ArrowDown: Focus to the next item in the list\r\n     * ArrowUp: Focus to the previous item in the list\r\n     * Enter: Select the currently focused item\r\n     * @param {KeyboardEvent} event\r\n     */\r\n    private onListkeyup(event: KeyboardEvent): void {\r\n        event.preventDefault();\r\n        if (Utils.IsKeyPressed(event, 'Escape')) {\r\n            this._value = null;\r\n            this.close();\r\n        } else if (Utils.IsKeyPressed(event, 'ArrowDown') || Utils.IsKeyPressed(event, 'ArrowUp')) {\r\n            this.focusNextItem(Utils.IsKeyPressed(event, 'ArrowDown') ? 1 : -1);\r\n        } else if (Utils.IsKeyPressed(event, 'Enter')) {\r\n            let focusedItem: HTMLElement = document.activeElement as HTMLElement;\r\n            if (focusedItem.classList.contains('combobox__item')) {\r\n                let val: any = this.findDataField(focusedItem);\r\n                this.setValue(val);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Called when the user clicks the dropdown button\r\n     * @param {Event} event\r\n     */\r\n    private onToggleclick(event: Event): void {\r\n\r\n        if (this.isOpen) {\r\n            this._value = null;\r\n            this.close();\r\n        } else {\r\n            this.open();\r\n        }\r\n\r\n    }\r\n\r\n    /**\r\n     * Updates the filter list with passed items.\r\n     *      * Adds event listener to the filter to uncheck the\r\n     *      * corresponding checkbox and rebuild the filterlist.\r\n     * @param collection The filters we are adding\r\n     */\r\n    private updateFilterList(collection: Array<any>): void {\r\n        let container: HTMLElement = this.getFilterContainer();\r\n        container.innerHTML = '';\r\n        let index: number;\r\n\r\n        for (let i: number = 0; i < collection.length; i++) {\r\n            index = i;\r\n            let filterNode: HTMLElement = Utils.CreateNode('<li tabindex=\"0\">' + collection[i] + '</li>');\r\n            filterNode.id = i.toString();\r\n\r\n            filterNode.addEventListener('click', (event: MouseEvent) => this.onFilterLabelClick(event.target));\r\n\r\n            filterNode.addEventListener('keyup', (event: KeyboardEvent) => {\r\n                if (Utils.IsKeyPressed(event, 'Enter')) {\r\n                    this.onFilterLabelClick(event.target);\r\n                }\r\n            });\r\n            container.appendChild(filterNode);\r\n        }\r\n    }\r\n\r\n    private onFilterLabelClick(element: EventTarget): void {\r\n        // uncheck the corresponding checkbox if we are using\r\n        // a checkbox filter\r\n        if (this.isCheckboxFilter) {\r\n\r\n            let filterNode: HTMLElement = element as HTMLElement;\r\n\r\n            let controllingCheckbox: HTMLInputElement =\r\n                this._list.querySelectorAll('.input__control:checked')[filterNode.id] as HTMLInputElement;\r\n\r\n            controllingCheckbox.checked = false;\r\n\r\n            let container: HTMLElement = this.getFilterContainer();\r\n\r\n            // rebuild the list\r\n            this.buildFilterList();\r\n\r\n            // check focus\r\n            if (container.querySelectorAll('li').length === 0) {\r\n                // focus list\r\n                this._input.focus();\r\n            } else {\r\n                // focus previous element\r\n                let previousSibling: number = parseInt(filterNode.id) > 0 ? parseInt(filterNode.id) - 1 : 0;\r\n                let focusableItem: HTMLElement = container.querySelectorAll('li')[previousSibling] as HTMLElement;\r\n                focusableItem.focus();\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n    /**\r\n     * Adds a list--filter to the combobox for showing the\r\n     * currently checked checkboxes.\r\n     * If the element does not exist within the host, a new\r\n     * element will be inserted.\r\n     */\r\n    private getFilterContainer(): HTMLElement {\r\n\r\n        // if no element is referenced\r\n        if (this._filterContainer === null) {\r\n\r\n            // does a list--filter already exist on the host?\r\n            this._filterContainer = this.host.querySelector('.list--filter') as HTMLElement;\r\n            if (this._filterContainer === null) {\r\n                // create a new list--filter and add it before the input\r\n                this._filterContainer = Utils.CreateNode(`<ul class=\"list list--filter list--filter-inline list--filter-closable\" />`);\r\n                this.host.insertBefore(this._filterContainer, this.host.querySelector('.combobox__input'));\r\n            }\r\n        }\r\n\r\n        return this._filterContainer;\r\n    }\r\n\r\n    /**\r\n     * Prepares the filterlist by passing all checked boxes to the updateFilterList\r\n     */\r\n    private buildFilterList(): void {\r\n        this._value = [];\r\n        let checkedItems: NodeListOf<Element> = this._list.querySelectorAll('.input__control:checked');\r\n        for (let i: number = 0; i < checkedItems.length; i++) {\r\n            this._value.push(checkedItems[i].parentElement.querySelector('.input__label').textContent);\r\n        }\r\n        this.updateFilterList(this._value);\r\n    }\r\n\r\n    /**\r\n     * Set the value of the input based on a list item\r\n     * Dispatches an 'combobox-select' event\r\n     * @param {string} value\r\n     */\r\n    private setValue(value: any): void {\r\n        let event: any = document.createEvent('CustomEvent');\r\n        event.initEvent('combobox-select', true, true);\r\n        event.data = value;\r\n\r\n        if (!this.isCheckboxFilter && this.host.dispatchEvent(event)) {\r\n            this.value = value;\r\n            this.close();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Scaffolding, add correct classes & elements\r\n     */\r\n    private setup(): void {\r\n        if (!this.host.querySelector('.combobox__input')) {\r\n            throw new Error('Host element should contain a text input');\r\n        }\r\n\r\n        if (!this.host.classList.contains('combobox')) {\r\n            this.host.classList.add('combobox');\r\n        }\r\n\r\n        // Check if the icon is present\r\n        if (!this.host.querySelector('.combobox__icon')) {\r\n            this._icon = Utils.CreateNode(`<i class=\"combobox__icon icon icon-magnifier\" role=\"presentation\"></i>`) as HTMLElement;\r\n            this.host.appendChild(this._icon);\r\n        }\r\n\r\n        // Check if the button is present\r\n        this._toggle = this.host.querySelector('.combobox__toggle');\r\n\r\n        if (!this._toggle) {\r\n            // No button, create it\r\n            this._toggle = Utils.CreateNode(`<button type=\"button\" class=\"combobox__toggle\"></button>`);\r\n            this.host.appendChild(this._toggle);\r\n        }\r\n\r\n        // Check if the autocomplete list is present\r\n        if (!this.host.querySelector('.combobox__autocomplete')) {\r\n            let list: Element = Utils.CreateNode(\r\n                `<div class=\"combobox__autocomplete\">\r\n                     <div class=\"combobox__list-wrapper\">\r\n                         <ul class=\"combobox__list\" tabindex=\"0\" hidden>\r\n                         </ul>\r\n                     </div>\r\n                 </div>`);\r\n\r\n            this.host.appendChild(list);\r\n\r\n        }\r\n\r\n        // Store a reference to the <ul>\r\n        this._list = this.host.querySelector('.combobox__list') as HTMLElement;\r\n\r\n        // When we allow multiple, we create compact checkboxes from the element children\r\n        if (this.isCheckboxFilter) {\r\n\r\n            // add the modifier\r\n            this._list.classList.add('combobox__list--multiple');\r\n\r\n            this._list.setAttribute('tabindex', '-1');\r\n\r\n            // get reference to the current input\r\n            let checkboxValues: HTMLInputElement = this.host.querySelector('.combobox__input') as HTMLInputElement;\r\n\r\n            // use the _data for storing the items\r\n            this._data = [];\r\n            for (let i: number = 0; i < checkboxValues.children.length; i++) {\r\n                this._data.push({ name: checkboxValues.children[i].textContent, value: '' });\r\n            }\r\n\r\n            // swap the current element with an original input and copy the classes\r\n            let inputElement: Element = Utils.CreateNode('<input />');\r\n            inputElement.className = checkboxValues.className;\r\n            this.host.replaceChild(inputElement, checkboxValues);\r\n\r\n            // create the items in the list\r\n            this.createListItems();\r\n\r\n            // create no result item in the  list\r\n            this.createNoResultItem();\r\n        }\r\n\r\n        // Store a reference to the <input>\r\n        this._input = this.host.querySelector('.combobox__input') as HTMLInputElement;\r\n    }\r\n\r\n    private setupListeners(): void {\r\n\r\n        // Add a click listener to the button\r\n        this._toggle.addEventListener('click', this);\r\n\r\n        this._input.addEventListener('keyup', this);\r\n        this._input.addEventListener('keydown', this);\r\n        this._input.addEventListener('input', this);\r\n\r\n        if (!this.isCheckboxFilter) {\r\n            this._list.addEventListener('click', this);\r\n        }\r\n\r\n        this._list.addEventListener('keyup', this);\r\n        this._list.addEventListener('keydown', this);\r\n\r\n        document.body.addEventListener('click', this);\r\n    }\r\n\r\n    /**\r\n     * Removes all the listitems from the suggest list\r\n     */\r\n    private removeListItems(): void {\r\n        // list.remove\r\n        while (this._list.lastChild) {\r\n            this._list.removeChild(this._list.lastChild);\r\n        }\r\n    }\r\n}\r\n"]}